<context name="default">
  <extension name="localized-dialplan">
    <!--
	Emergency service - verify your provider really supports this
      -->
    <condition field="${destination_number}" expression="${default_emergency_number}" continue="true" break="never">
      <action application="export" data="nolocal:jitterbuffer_msec=180"/>
      <action application="bridge" data="sofia/gateway/${default_gateway}/$1"/>
    </condition>
    <!--
	For international
      -->
    <condition field="${destination_number}" expression="${default_international_regexp}" continue="true" break="never">
      <action application="set" data="e164number=$1"/>
    </condition>
    <!--
	For in country but out of area
      -->
    <condition field="${destination_number}" expression="${default_domestic_regexp}" continue="true" break="never">
      <action application="set" data="e164number=${default_country_code}$1"/>
    </condition>
    <!--
	For same city calls
      -->
    <condition field="${destination_number}" expression="${default_local_regexp}" continue="true" break="never">
      <action application="set" data="e164number=${default_country_code}${default_local_prefix}$1"/>
    </condition>

    <!--
	Dial the call
      -->
    <condition field="${e164number}" expression="^\d+$" continue="true">
      <action application="info"/>
      <action application="export" data="nolocal:jitterbuffer_msec=180"/>
      <action application="set" data="continue_on_fail=true"/>
      <action application="set" data="hangup_after_bridge=true"/>
      <action application="set" data="call_timeout=45"/>
      <action application="set" data="hangup_after_bridge=true"/>
      <action application="set" data="continue_on_fail=true"/>
    </condition>
    <condition field="${use_enum}" expression="^yes$" continue="true" break="never">
      <action application="enum" data="${e164number}"/>
      <action application="bridge" data="${enum_auto_route}"/>
    </condition>
    <condition>
      <action application="bridge" data="sofia/gateway/${default_gateway}/${e164number}"/>
    </condition>
  </extension>

</context>
